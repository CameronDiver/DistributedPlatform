#include "stdint.h"
#include "stdlib.h"

typedef int (*ProcessMain)(unsigned int, const char **);

typedef struct
{	
	uint16_t argc;
	const char **argv; // TODO: Static assert that sizeof(char)==1?
	ProcessMain main;
}StdlibProcessInfo;

////////////////////////////////////////////////////////////////////////////////
// Private prototypes.
////////////////////////////////////////////////////////////////////////////////

void _start(const void *);

////////////////////////////////////////////////////////////////////////////////
// Public functions.
////////////////////////////////////////////////////////////////////////////////

int Dabs(int x) {
	return (x>=0 ? x : -x);
}

void Dexit(int status) {
	sys_exit(status);
}

////////////////////////////////////////////////////////////////////////////////
// Private functions.
////////////////////////////////////////////////////////////////////////////////

void _start(const void *ptr) {
	const StdlibProcessInfo *info=(const StdlibProcessInfo *)ptr;
	Dexit((*info->main)(info->argc, info->argv));
}
